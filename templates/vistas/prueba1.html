<!DOCTYPE html>
<html lang="es">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Consultas</title>

    <!-- Incluye Bootstrap 5 desde una CDN -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">

    <!-- Incluye jQuery desde una CDN -->
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.6.0/jquery.min.js"></script>

    <!-- Estilos adicionales -->
    <style>
        /* Estilos para animación en el nav */
        nav ul li {
            transition: background-color 0.3s;
        }

        nav ul li:hover {
            background-color: #f8f9fa;
        }

        /* Estilo para formatear el JSON */
        pre {
            white-space: pre-wrap;
            word-wrap: break-word;
        }

        /* Personalización de estilos adicionales */
        .header {
            padding: 10px;
            background-color: #007bff;
            color: white;
            border-radius: 5px;
        }

        #resultado strong {
            font-weight: bold;
        }

        #resultado span {
            font-style: italic;
        }
    </style>
</head>

<body>
    <!-- Header con navegación -->
    <header class="header mb-4">
        <nav class="navbar navbar-expand-lg navbar-dark">
            <a class="navbar-brand" href="#">Consultas</a>
            <div class="collapse navbar-collapse" id="navbarNav">
                <ul class="navbar-nav">
                    <li class="nav-item">
                        <a class="nav-link" href="#">Inicio</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="#">Acerca de</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="#">Contacto</a>
                    </li>
                </ul>
            </div>
        </nav>
    </header>

    <!-- Formulario para elegir tipo de consulta y valor a consultar -->
    <div class="container">
        <form id="consultaForm" class="mb-3">
            <div class="mb-3">
                <!-- Selecciona el tipo de consulta -->
                <label for="consultaTipo" class="form-label">Tipo de consulta:</label>
                <select id="consultaTipo" name="tipo" class="form-select">
                    <option value="dni">DNI</option>
                    <option value="ruc">RUC</option>
                    <option value="matricula">Matrícula</option>
                </select>
            </div>

            <div class="mb-3">
                <!-- Input para ingresar el valor a consultar -->
                <label for="consultaValor" class="form-label">Valor:</label>
                <input type="text" id="consultaValor" name="valor" class="form-control" required>
            </div>

            <!-- Botón para iniciar la consulta -->
            <button type="submit" class="btn btn-primary">Consultar</button>
        </form>

        <!-- Elemento para mostrar los datos obtenidos -->
        <div id="resultado" class="border p-3 rounded"></div>
    </div>

    <!-- Código JavaScript -->
    <script>
        // El token JWT
        const token = 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIzOTkiLCJuYW1lIjoiY2FybG9zTW9yaTI4IiwiZW1haWwiOiJjZWdtY2FybG9zOTg3QGdtYWlsLmNvbSIsImh0dHA6Ly9zY2hlbWFzLm1pY3Jvc29mdC5jb20vd3MvMjAwOC8wNi9pZGVudGl0eS9jbGFpbXMvcm9sZSI6ImNvbnN1bHRvciJ9.lOQWVQhrxupKVNlJLRu2Xdsai7mfPuDD3Vcc-lixqP8';

        // URL base de la API
        const baseUrl = 'https://api.factiliza.com/pe/v1/';

        // Función para realizar la consulta a la API usando AJAX
        function consultar(valor, tipo) {
            // Construye la URL de la API según el tipo de consulta
            let url;
            if (tipo === 'dni') {
                url = `${baseUrl}dni/info/${valor}`;
            } else if (tipo === 'ruc') {
                url = `${baseUrl}ruc/info/${valor}`;
            } else if (tipo === 'matricula') {
                url = `${baseUrl}placa/info/${valor}`;
            }

            // Realiza la solicitud AJAX
            $.ajax({
                url: url,
                method: 'GET',
                headers: {
                    'Authorization': `Bearer ${token}`,
                    'Content-Type': 'application/json'
                },
                success: function(datos) {
                    mostrarResultado(datos, tipo);
                },
                error: function(xhr, status, error) {
                    $('#resultado').text(`Error: ${xhr.status} - ${xhr.statusText}`);
                }
            });
        }

        // Función para mostrar los resultados de la consulta
        function mostrarResultado(datos, tipo) {
            if (datos.status === 200 && datos.message === 'Exito') {
                let resultadoHTML = '';
                const data = datos.data;

                if (tipo === 'dni') {
                    resultadoHTML += `<p><strong>Número:</strong> <span>${data.numero}</span></p>`;
                    resultadoHTML += `<p><strong>Nombres:</strong> <span>${data.nombres}</span></p>`;
                    resultadoHTML += `<p><strong>Apellido paterno:</strong> <span>${data.apellido_paterno}</span></p>`;
                    resultadoHTML += `<p><strong>Apellido materno:</strong> <span>${data.apellido_materno}</span></p>`;
                    resultadoHTML += `<p><strong>Nombre completo:</strong> <span>${data.nombre_completo}</span></p>`;
                    resultadoHTML += `<p><strong>Departamento:</strong> <span>${data.departamento}</span></p>`;
                    resultadoHTML += `<p><strong>Provincia:</strong> <span>${data.provincia}</span></p>`;
                    resultadoHTML += `<p><strong>Distrito:</strong> <span>${data.distrito}</span></p>`;
                    resultadoHTML += `<p><strong>Dirección:</strong> <span>${data.direccion}</span></p>`;
                    resultadoHTML += `<p><strong>Dirección completa:</strong> <span>${data.direccion_completa}</span></p>`;
                    resultadoHTML += `<p><strong>Estado civil:</strong> <span>${data.estado_civil}</span></p>`;
                    // Aquí puedes agregar más campos según la respuesta de la API
                } else if (tipo === 'ruc') {
                    resultadoHTML += `<p><strong>Número:</strong> <span>${data.numero}</span></p>`;
                    resultadoHTML += `<p><strong>Nombre o razón social:</strong> <span>${data.nombre_o_razon_social}</span></p>`;
                    resultadoHTML += `<p><strong>Tipo de contribuyente:</strong> <span>${data.tipo_contribuyente}</span></p>`;
                    resultadoHTML += `<p><strong>Estado:</strong> <span>${data.estado}</span></p>`;
                    resultadoHTML += `<p><strong>Condición:</strong> <span>${data.condicion}</span></p>`;
                    resultadoHTML += `<p><strong>Departamento:</strong> <span>${data.departamento}</span></p>`;
                    resultadoHTML += `<p><strong>Provincia:</strong> <span>${data.provincia}</span></p>`;
                    resultadoHTML += `<p><strong>Distrito:</strong> <span>${data.distrito}</span></p>`;
                    resultadoHTML += `<p><strong>Dirección:</strong> <span>${data.direccion}</span></p>`;
                    resultadoHTML += `<p><strong>Dirección completa:</strong> <span>${data.direccion_completa}</span></p>`;
                    // Aquí puedes agregar más campos según la respuesta de la API
                } else if (tipo === 'matricula') {
                    resultadoHTML += `<p><strong>Placa:</strong> <span>${data.placa}</span></p>`;
                    resultadoHTML += `<p><strong>Marca:</strong> <span>${data.marca}</span></p>`;
                    resultadoHTML += `<p><strong>Modelo:</strong> <span>${data.modelo}</span></p>`;
                    resultadoHTML += `<p><strong>Serie:</strong> <span>${data.serie}</span></p>`;
                    resultadoHTML += `<p><strong>Color:</strong> <span>${data.color}</span></p>`;
                    resultadoHTML += `<p><strong>Motor:</strong> <span>${data.motor}</span></p>`;
                    resultadoHTML += `<p><strong>VIN:</strong> <span>${data.vin}</span></p>`;
                    // Aquí puedes agregar más campos según la respuesta de la API
                }

                // Muestra el resultado en el elemento 'resultado'
                $('#resultado').html(resultadoHTML);
            } else {
                $('#resultado').text(`Error: No se encontró información o hubo un problema con la consulta.`);
            }
        }

        // Añade un evento de envío al formulario
        $('#consultaForm').on('submit', function(event) {
            // Evita el envío del formulario por defecto
            event.preventDefault();

            // Obtiene el tipo de consulta y el valor del formulario
            const tipo = $('#consultaTipo').val();
            const valor = $('#consultaValor').val();

            // Llama a la función de consulta con los valores del formulario
            consultar(valor, tipo);
        });
    </script>
</body>
</html>